<!DOCTYPE html>
<html lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="design/styles.css">

<!-- jQuery imports -->
<!--<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>-->
            
<link href="jquery/jquery-ui-1.8.16.custom.css" rel="stylesheet" type="text/css"/>
  <script src="jquery/jquery.min.js"></script>
  <script src="jquery/jquery-ui.min.js"></script>


<script type="text/javascript" src="openwebglobe_0.6.js"></script>
<!--<script type="text/javascript" src="../../../WebViewerMainFork/WebViewer/external/closure-library/closure/goog/base.js"></script>
<script type="text/javascript" src="../../../WebViewerMainFork/WebViewer/compiled/deps.js"></script>
<script type="text/javascript">goog.require('owg.OpenWebGlobe');</script>-->

<script type="text/javascript" src="guihelpers.js"></script>
<script type="text/javascript" src="rtposmodule.js"></script>
<script type="text/javascript" src="pointcloudfilemanager.js"></script>
<script type="text/javascript" src="pcfile.js"></script>
<script type="text/javascript" src="wgs84_ch1903.js"></script>
<script type="text/javascript" src="viewpanel.js"></script>
<script type="text/javascript" src="pointcloudpanel.js"></script>
<script type="text/javascript" src="realtimepanel.js"></script>
<script type="text/javascript" src="rtpointcloudpanel.js"></script>

<script type="text/javascript">


//--------------- Definition Section -------------------------------------------
//------------------------------------------------------------------------------


const const_rtpcfilefolder = "pcdata";
const const_maxpointcloudfiles = 20;
const const_pcfilerefreshinterval = 2000;


//const const_wsaddress = 'ws://127.0.0.1:4123/consoleappsample';
const const_wsaddress = 'ws://10.218.9.120:4123/consoleappsample';
//const const_wsaddress = 'ws://10.10.5.130:4123/consoleappsample';

const const_wsreconnectinterval = 10000;

//frustum size
// eth
const const_frustumleft = -0.5;
const const_frustumright = 0.5;
const const_frustumbottom = -0.5;
const const_frustumtop = 0.5;
const const_frustumznear = -1;
const const_frustumzfar = -5;

//cube
// icare1
const const_icare1size = 2;
const const_icare1color = [1,0,0,0.3];
const const_icare2size = 2;
const const_icare2color =[0,1,0,0.3];


//--------------- Global Vars --------------------------------------------------
//------------------------------------------------------------------------------
var ctx;
var scene;
var globe;
var world;
var cam;
var rtmodule;


//--------------- Main ---------------------------------------------------------
//------------------------------------------------------------------------------
function main()
{
   //og Settings
   ctx = ogCreateContextFromCanvas("canvas", true);
	
	
   globe = ogCreateGlobe(ctx);
   scene = ogGetScene(ctx);
   world = ogGetWorld(scene);
   cam = ogGetActiveCamera(scene);
   
   ogSetBackgroundColor(ctx, 0.2,0.2,0.7,1);
	ogSetCanvasSizeOffset(scene,16,88);

/*
   //set up image data source
   var imgSWISSTOPO = 
   {
      url     : ["http://owgdemo/data/img"],
      layer   : "swissimage", 
      service : "owg"
   };
	
	var elvDHM =
	{
		url     : ["http://owgdemo/data/elv"],
      layer   : "DHM25",
      service : "owg"
	}

	ogAddImageLayer(globe, imgSWISSTOPO);
   ogAddElevationLayer(globe, elvDHM);
*/

			ogAddImageLayer(globe, {
				url: ["http://owgdemo/data"],
				layer: "bluemarble",
				service: "owg"
			});
			ogAddImageLayer(globe, {
				url: ["http://owgdemo/data"],
				layer: "swissimage",
				service: "owg"
			});
			ogAddElevationLayer(globe, {
				url: ["http://owgdemo/data"],
				layer: "DHM25",
				service: "owg"
			});

 

  
   //Fly to start position
   ogSetPosition(cam,7.600771,46.760578,7000)
	
	
	//set up panels
	createViewPanel(document.getElementById('divViewOptions'));
	createPointCloudPanel(document.getElementById('divPointCloudOptions'));
	createRtPointCloudPanel(document.getElementById('divRealTimePcOptions'));
	createRealTimePanel(document.getElementById('divRealTimeDataOptions'));
	
	setInterval("settime()", 1000);
}


//------- Show the time --------------------------------------------------------
function settime () {
  var curtime = new Date();
  var curhour = curtime.getHours();
  var curmin = curtime.getMinutes();
  var cursec = curtime.getSeconds();
  var time = "";
 
  
  time = (curhour) + ":" +
         (curmin < 10 ? "0" : "") + curmin + ":" +
         (cursec < 10 ? "0" : "") + cursec + " ";
 
  var timepanel = document.getElementById("divTimeDisplay");
  timepanel.innerHTML = time;
}

   
</script>
</head>
<body onload="main()">
	
   <div id="divHeader">
		<div id="divLogoArmasuisse"></div>
		<div id="divLogoAll"></div>
		<div id="divTimeDisplay"></div>
	</div>
	<div id="divcanvas">
		<canvas id="canvas"></canvas>
	</div>
   <div id="divViewOptions"></div>
   <div id="divPointCloudOptions"></div>
   <div id="divRealTimeDataOptions"></div>
	<div id="divRealTimePcOptions"></div>
   <div id="divConfigOptions"></div>
	
	
</body>
</html>
